---

- name: Set noninteractive moce
  shell: export DEBIAN_FRONTEND=noninteractive

- name: Configure MariaDB Installation
  debconf:
   name: mariadb-server
   question: "{{ item }}"
   vtype: password
   value: "{{ mysql_root_pass }}"
  with_items:
   - mysql-server/root_password
   - mysql-server/root_password_again
  register: configure_install

- name: Install MariaDB with custom configuration
  apt:
   name: mariadb-server
   state: latest
   update_cache: true
  when: configure_install | success
  register: install_mariadb
  notify:
   - Add remote access
   - Add users
   - Add databases
   - Add tables
   - Mariadb start enable


- name: Generate galera conf
  template:
   src: galera.cnf.j2
   dest: /etc/mysql/conf.d/
